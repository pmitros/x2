<!DOCTYPE html>
<html>
<head>

    <title>Canvas 5 benchmarking </title>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src='/static/js/fastclick.js'></script>
    <style type="text/css">

        canvas {
            border: 1px solid black;
            cursor: crosshair;
        }

        .info {
            float: left;
            margin-right: 40px;
        }

        .info span {

            font-weight: bold;
        }

        button {
            padding: 10px;
        }
    </style>

    <script>

        var lmb_down = false
        var inline = false
        var last_point;
        var last_timestamp = 0;
        var modes = {'point':1, 'line':2}
        var mode = modes['point']
        nevt = 0
        runavg = 0

        var PEN = false // pointer enabled device

        var PRESSURE_COLOR = false
        var PRESSURE_WIDTH = true
        var PRESSURE_WEIGHT = 1

        CURVES = []
        curcurv = []
        collecting = false

        CAPTURE = [[[58,88,0],[58,88,7],[58,84,15],[59,90,35],[59,94,43],[60,99,54],[61,105,60],[61,112,68],[61,119,75],[61,125,84],[61,131,91],[61,137,95],[61,141,104],[61,145,111]],[[25,104,345],[21,102,351],[23,98,375],[29,95,391],[34,93,397],[41,92,410],[48,91,413],[65,89,428],[73,89,437],[81,89,447],[88,89,453]],[[98,87,601],[96,88,607],[95,90,615],[95,94,623],[94,98,631],[94,102,635],[93,108,643],[93,114,651],[93,120,659],[93,125,668],[93,129,675],[94,133,683],[94,135,691],[96,137,697],[98,137,709],[101,136,712],[104,134,721],[108,131,729],[111,128,737],[115,125,744],[118,123,753],[121,121,761],[123,120,764],[125,120,776],[126,121,781],[127,124,793],[127,126,796],[127,130,810],[127,133,812],[127,136,817],[127,138,828],[128,140,832]],[[144,134,893],[146,132,899],[148,131,907],[150,130,915],[152,128,923],[154,127,931],[155,126,935],[156,124,943],[157,123,951],[157,121,959],[157,120,969],[157,119,977],[155,119,985],[154,119,993],[152,119,996],[150,121,1005],[147,123,1014],[145,125,1021],[143,129,1030],[142,132,1037],[141,135,1046],[141,138,1053],[143,141,1062],[145,143,1065],[148,145,1078],[152,145,1081]],[[246,124,1304],[244,126,1311],[243,128,1319],[241,131,1327],[240,134,1335],[239,136,1343],[239,139,1351],[240,140,1357],[241,141,1363],[243,140,1372],[245,139,1379],[248,136,1389],[250,133,1397],[253,130,1405],[255,126,1413],[255,123,1416],[256,120,1429],[255,118,1432],[254,117,1446],[253,118,1449],[252,119,1457],[251,122,1468],[250,125,1473],[250,129,1477],[250,134,1487],[250,140,1497],[251,145,1501],[252,151,1511],[253,155,1516],[254,159,1528],[256,163,1532],[258,165,1536],[259,166,1544],[261,166,1552],[264,164,1561],[266,162,1568],[268,158,1578],[270,154,1584],[273,146,1595],[274,143,1604],[275,139,1611],[276,136,1620],[276,134,1628],[277,133,1636],[279,132,1645],[280,131,1652]],[[295,124,1749],[295,123,1755],[294,124,1783],[294,126,1792],[295,128,1799],[295,130,1809],[296,133,1815],[296,135,1826],[298,137,1831],[299,139,1837],[301,140,1846],[303,139,1852],[305,139,1863],[308,137,1869],[310,136,1880],[312,134,1884],[316,130,1896],[318,129,1905],[319,128,1913],[320,129,1931],[321,130,1937],[321,132,1949],[321,135,1953],[322,137,1956],[322,139,1967],[323,141,1973],[323,142,1984],[324,142,1988],[325,141,1996]],[[337,134,2065],[338,136,2071],[339,138,2075],[339,140,2083],[339,141,2093],[339,143,2099],[339,144,2107]],[[335,123,2196],[335,120,2203],[336,118,2211],[337,116,2219],[338,115,2227],[339,115,2235]],[[372,130,2392],[372,129,2399],[371,128,2407],[370,127,2423],[368,129,2431],[366,130,2435],[365,132,2444],[363,135,2451],[361,138,2461],[359,141,2469],[358,148,2484],[358,150,2493],[360,151,2501],[362,151,2504],[365,151,2516],[368,150,2521],[372,148,2535],[376,146,2538]],[[398,105,2725],[399,105,2731],[400,106,2735],[401,107,2746],[401,109,2751],[401,113,2759],[401,117,2767],[400,122,2775],[399,126,2783],[399,131,2791],[398,136,2797],[398,139,2804],[399,142,2816],[400,144,2821],[402,144,2833],[405,144,2836],[408,142,2851],[410,140,2853],[413,138,2856],[415,135,2866],[417,132,2872],[418,130,2883],[419,129,2888],[419,127,2900],[417,129,2916],[417,131,2925],[417,133,2933],[417,135,2940],[417,138,2951],[418,140,2957],[419,142,2969],[421,143,2973],[423,144,2976],[425,145,2987],[426,145,2993],[428,144,3004]],[[494,99,3333],[493,101,3335],[493,103,3343],[492,107,3351],[491,112,3359],[490,117,3367],[490,123,3375],[489,129,3383],[488,134,3391],[488,138,3398],[488,142,3403],[488,145,3411],[488,146,3419],[489,146,3429],[491,145,3437],[493,144,3445],[495,141,3454],[497,139,3456],[499,137,3469],[501,135,3472],[503,133,3486],[505,133,3489],[507,133,3502],[508,134,3505],[509,136,3513],[510,138,3516],[511,141,3524],[511,143,3536],[511,146,3540],[509,148,3555],[508,150,3559],[505,151,3572],[502,152,3589],[492,152,3592],[488,150,3603],[486,148,3614],[485,146,3617],[485,144,3627]],[[530,148,3729],[530,150,3735],[530,152,3743],[530,154,3751],[529,155,3755],[528,156,3765],[527,155,3771],[526,154,3779],[525,153,3787],[525,151,3795],[526,148,3803],[527,145,3811],[528,142,3815],[530,140,3823],[533,137,3832],[536,136,3839],[540,135,3849],[543,134,3855],[546,134,3866],[549,135,3871],[551,136,3877],[553,137,3889],[554,139,3892],[555,141,3906],[555,143,3909],[555,145,3922],[555,147,3926],[555,148,3940],[556,149,3945],[557,148,3956],[558,147,3961],[558,146,3972],[559,144,3977],[558,142,3989],[558,140,3993],[556,139,3997],[554,137,4007],[552,137,4013],[550,136,4024],[548,137,4028],[547,137,4040]],[[580,138,4232],[580,139,4235],[579,141,4243],[578,143,4251],[577,145,4259],[577,147,4267],[576,149,4275],[576,151,4284],[577,152,4291],[579,153,4295],[580,153,4303],[582,153,4311],[585,153,4319],[588,152,4327],[590,152,4335],[592,151,4343],[595,151,4351],[596,151,4357],[598,152,4365],[599,152,4373],[600,152,4381],[601,151,4388],[601,150,4397],[602,149,4404],[603,147,4413],[603,144,4421],[604,142,4424],[604,140,4432],[603,138,4441],[603,137,4449],[603,136,4457]],[[628,140,4653],[630,141,4655],[631,142,4663],[632,144,4671],[632,146,4679],[633,148,4687],[633,150,4695],[634,151,4703],[635,152,4711],[636,151,4715],[637,151,4723],[639,150,4731],[641,148,4739],[643,147,4747],[646,147,4755],[648,146,4763],[649,147,4771],[650,148,4776],[651,150,4801],[650,154,4803],[650,157,4811],[650,158,4817],[650,160,4824]],[[730,114,5005],[730,113,5011],[730,111,5015],[731,113,5039],[731,116,5047],[731,120,5055],[730,125,5063],[730,131,5071],[728,137,5075],[727,143,5083],[725,149,5091],[723,154,5099],[721,158,5107],[719,162,5115],[717,165,5123],[716,167,5131]],[[700,145,5312],[701,145,5316],[703,145,5323],[705,144,5331],[708,145,5339],[711,145,5347],[715,145,5355],[720,145,5363],[725,146,5371],[729,146,5375],[734,146,5383],[738,146,5391],[742,147,5399],[744,148,5407],[746,148,5415],[748,149,5423],[749,151,5431],[749,152,5437],[750,153,5443],[750,154,5451],[752,154,5468],[753,154,5479],[754,153,5485],[757,151,5497],[758,149,5511],[758,147,5514],[757,143,5529],[756,142,5537],[754,142,5548],[751,141,5553],[750,142,5557],[748,143,5567],[747,144,5577],[747,145,5581],[748,147,5591]],[[790,170,5733],[788,171,5735],[787,170,5743],[787,169,5759],[788,168,5769],[789,166,5778],[792,164,5785],[795,161,5793],[798,158,5796],[801,155,5810],[805,152,5813],[807,148,5821],[809,145,5829],[811,142,5837],[811,139,5845]],[[799,142,5904],[798,146,5911],[799,149,5915],[800,153,5923],[801,157,5931],[803,161,5939],[805,164,5947],[807,167,5956],[810,169,5963],[812,170,5972],[814,170,5975]],[[876,150,6437],[876,148,6443],[878,145,6451],[879,143,6458],[880,140,6463],[882,138,6472],[884,136,6479],[885,135,6487],[887,135,6495],[888,136,6503],[889,139,6511],[890,142,6517],[890,147,6531],[890,152,6534],[888,162,6549],[885,172,6566],[883,175,6575],[882,177,6579],[881,178,6589],[879,177,6600]],[[881,118,6713],[881,117,6719],[882,117,6735],[883,118,6743],[885,119,6751]],[[901,133,6824],[901,136,6831],[901,139,6839],[901,142,6847],[901,145,6855],[902,148,6863],[904,150,6871],[906,150,6876],[909,150,6883],[912,149,6892],[916,148,6899],[919,146,6909],[922,144,6915],[924,142,6925],[926,140,6931],[926,141,6952],[926,142,6963],[926,144,6968],[926,146,6980],[927,148,6985],[929,152,6997]],[[963,139,7269],[961,141,7275],[960,143,7283],[959,146,7294],[958,149,7295],[957,152,7303],[957,155,7311],[957,157,7319],[958,159,7327],[959,159,7335],[961,159,7344],[964,158,7351],[967,156,7357],[970,155,7368],[972,152,7374],[975,150,7387],[977,148,7391],[978,146,7401],[979,145,7405],[980,144,7417],[980,146,7433],[980,147,7441],[980,148,7452],[981,149,7457],[982,150,7467],[983,151,7473],[986,151,7476],[989,150,7483],[992,149,7492],[995,148,7500],[998,148,7508],[1001,147,7515],[1003,147,7524],[1005,148,7531],[1006,149,7536],[1006,150,7550],[1007,152,7553],[1008,155,7569],[1010,155,7585]],[[1028,147,7645],[1029,148,7651],[1029,150,7655],[1030,153,7663],[1029,156,7671],[1028,160,7679],[1027,165,7687],[1026,170,7695],[1024,176,7703],[1023,181,7711],[1020,187,7716],[1018,192,7724],[1016,197,7732],[1014,201,7740],[1012,204,7748],[1010,206,7756],[1008,207,7765],[1007,206,7772],[1006,204,7777],[1006,202,7785],[1006,198,7793],[1006,194,7800],[1007,189,7808],[1008,184,7816],[1009,178,7824],[1011,172,7832],[1014,166,7837],[1021,155,7852],[1025,150,7862],[1029,146,7872],[1033,143,7877],[1038,141,7888],[1042,140,7893],[1045,140,7897],[1047,142,7907],[1049,144,7918],[1049,147,7921],[1049,151,7933],[1047,154,7936],[1046,158,7950],[1043,161,7952],[1041,163,7957],[1039,164,7968],[1038,164,7973]],[[1060,152,8065],[1061,153,8071],[1061,154,8075],[1061,155,8083],[1062,156,8091],[1063,156,8099],[1065,156,8107],[1067,156,8115],[1070,155,8123],[1072,153,8131],[1074,151,8135],[1076,149,8143],[1078,147,8151],[1079,145,8159],[1078,143,8167],[1078,142,8175],[1076,142,8183],[1075,142,8191],[1073,143,8196],[1071,145,8203],[1068,148,8213],[1066,150,8219],[1065,154,8227],[1063,157,8235],[1064,160,8243],[1064,161,8251],[1066,163,8256],[1069,163,8267]],[[1093,148,8341],[1093,148,8347],[1094,148,8355],[1094,149,8364],[1094,151,8371],[1094,153,8375],[1095,155,8383],[1095,157,8391],[1096,158,8399],[1097,159,8407],[1098,159,8415],[1100,158,8423],[1102,157,8431],[1104,155,8436],[1105,152,8444],[1107,148,8453]],[[1111,127,8496],[1111,125,8503],[1111,126,8519],[1111,127,8527],[1110,130,8535],[1109,134,8543],[1108,138,8551],[1106,143,8555],[1104,148,8564],[1103,153,8571],[1102,157,8582],[1101,160,8588],[1101,163,8616],[1108,165,8619]],[[1174,140,8873],[1173,141,8879],[1171,143,8887],[1169,146,8896],[1166,149,8903],[1164,152,8911],[1162,155,8917],[1161,159,8924],[1161,162,8936],[1162,164,8941],[1167,165,8956],[1175,162,8974],[1179,160,8977],[1183,157,8988],[1185,153,8993],[1187,150,9005],[1186,147,9009],[1185,144,9022],[1183,143,9026],[1178,141,9040],[1176,140,9045],[1175,140,9056]],[[1203,148,9180],[1203,149,9187],[1202,151,9195],[1201,153,9203],[1201,155,9211],[1200,157,9216],[1199,160,9223],[1199,162,9233],[1199,163,9239],[1201,164,9255],[1203,163,9263],[1205,161,9271],[1208,159,9276],[1210,156,9287],[1212,153,9292],[1214,151,9304],[1216,148,9309],[1217,146,9320],[1217,144,9324],[1218,142,9338],[1219,141,9345],[1220,141,9354]],[[1230,154,9413],[1231,157,9419],[1231,159,9427],[1232,160,9435],[1233,161,9443],[1234,162,9451],[1236,162,9455],[1237,162,9463],[1239,161,9471],[1240,159,9479],[1241,157,9488],[1242,155,9496],[1242,153,9504],[1242,151,9512],[1242,149,9521],[1241,148,9524],[1239,147,9532],[1238,148,9540],[1236,148,9549],[1235,150,9560],[1233,152,9565],[1232,157,9575],[1232,160,9587],[1232,162,9592],[1233,164,9604],[1235,165,9608],[1237,166,9620],[1240,166,9624],[1242,165,9632],[1246,164,9639],[1248,162,9644],[1251,161,9654],[1254,159,9660]],[[1268,168,10201],[1268,168,10207],[1268,169,10215],[1269,168,10231],[1270,166,10237],[1271,165,10243],[1272,162,10253],[1273,160,10259],[1275,157,10270],[1276,154,10275],[1278,151,10283],[1279,148,10291],[1281,146,10295],[1283,144,10303],[1285,143,10311],[1287,142,10320],[1290,141,10329],[1294,141,10341]],[[1348,123,10484],[1348,123,10491],[1348,125,10499],[1347,127,10507],[1346,131,10515],[1344,136,10523],[1342,142,10531],[1340,148,10537],[1338,154,10543],[1336,160,10551],[1334,166,10559],[1333,171,10568],[1332,174,10576],[1332,177,10585],[1332,179,10593],[1333,180,10596]],[[1322,159,10713],[1322,159,10715],[1324,159,10739],[1326,158,10747],[1329,158,10755],[1332,157,10763],[1336,156,10771],[1340,154,10775],[1344,152,10783],[1348,150,10791],[1352,147,10799],[1356,144,10807],[1359,140,10815],[1362,136,10823],[1365,133,10831],[1367,130,10835],[1370,127,10843],[1372,125,10851],[1373,123,10859],[1374,122,10867],[1375,122,10875],[1376,123,10883],[1376,125,10891],[1375,127,10895],[1373,131,10905],[1372,136,10911],[1369,141,10919],[1367,146,10928],[1365,151,10937],[1362,155,10945],[1361,159,10953],[1359,162,10961],[1359,165,10964],[1359,166,10976],[1361,166,10980],[1362,166,10993],[1365,165,10996],[1367,163,11010],[1370,162,11013],[1372,161,11016],[1374,160,11028],[1376,160,11033],[1377,160,11045],[1377,161,11049],[1377,162,11062],[1378,164,11067],[1379,166,11093],[1382,166,11096]],[[1395,160,11136],[1397,158,11143],[1398,157,11151],[1400,156,11159],[1401,155,11168],[1402,154,11177],[1403,152,11185],[1403,151,11193],[1404,150,11196],[1402,151,11220],[1400,152,11230],[1398,154,11237],[1393,160,11248],[1390,163,11263],[1388,166,11266],[1386,171,11280],[1389,175,11297],[1391,176,11307],[1395,176,11311],[1399,176,11321],[1403,175,11325]],[[1469,128,11909],[1469,129,11915],[1469,131,11924],[1468,134,11931],[1466,137,11939],[1464,141,11947],[1462,146,11955],[1460,150,11963],[1458,155,11967],[1457,159,11975],[1456,162,11983],[1456,165,11992],[1457,166,11999]],[[1478,154,12097],[1478,155,12103],[1476,156,12111],[1475,158,12119],[1474,159,12127],[1474,161,12135],[1475,162,12143],[1476,162,12147],[1477,162,12155],[1479,162,12163],[1481,161,12171],[1483,159,12179],[1485,157,12187],[1486,156,12195],[1486,155,12203],[1486,156,12232],[1486,158,12241],[1486,161,12251],[1487,163,12257],[1491,167,12269],[1494,169,12282]],[[1519,146,12517],[1521,145,12523],[1524,146,12531],[1526,147,12539],[1528,148,12547],[1530,150,12555],[1531,152,12563],[1532,156,12567],[1533,159,12577],[1533,163,12583],[1532,167,12591],[1532,170,12599],[1531,173,12607],[1531,175,12615],[1531,178,12623],[1533,179,12635],[1534,179,12644],[1536,178,12651]],[[1528,155,12757],[1528,155,12763],[1528,156,12771],[1527,157,12779],[1528,158,12787],[1529,159,12795],[1530,160,12803],[1531,161,12807],[1533,162,12816],[1536,163,12825],[1539,163,12836],[1542,163,12841],[1544,163,12852],[1547,163,12856],[1552,161,12868],[1554,160,12877],[1556,159,12888],[1558,158,12893],[1559,157,12904],[1560,155,12909],[1561,154,12920],[1561,153,12924],[1561,155,12952],[1561,157,12961],[1560,160,12972],[1559,163,12977],[1559,171,12988],[1558,175,13002],[1558,179,13005],[1559,183,13019],[1559,186,13022],[1559,193,13036],[1559,197,13054],[1558,198,13057],[1557,199,13068],[1555,199,13073],[1553,199,13084],[1551,198,13089],[1548,196,13102],[1546,195,13106],[1543,192,13109],[1542,190,13120],[1541,188,13125],[1541,185,13136]],[[1613,157,13328],[1612,158,13335],[1611,160,13343],[1610,162,13347],[1608,164,13355],[1607,167,13363],[1606,170,13371],[1606,172,13380],[1606,175,13387],[1606,176,13396],[1607,177,13403],[1609,177,13407],[1610,176,13415],[1612,175,13423]],[[1625,137,13509],[1627,136,13515],[1627,135,13523],[1628,136,13527],[1627,138,13535],[1627,141,13543],[1625,144,13551],[1624,149,13559],[1621,154,13567],[1619,159,13575],[1617,164,13583],[1615,168,13587],[1614,172,13602],[1614,175,13606],[1614,177,13613],[1616,178,13624],[1618,178,13629]],[[1636,173,13673],[1637,172,13679],[1638,172,13687],[1639,172,13703],[1640,173,13707],[1641,175,13723],[1642,175,13731],[1644,175,13739],[1646,175,13748],[1647,175,13755],[1649,174,13764],[1651,173,13767],[1651,171,13775],[1651,170,13783],[1651,169,13791],[1650,167,13799],[1648,166,13807],[1647,165,13815],[1645,164,13823],[1645,163,13827]],[[1671,167,13921],[1672,168,13927],[1672,170,13935],[1673,171,13943],[1673,172,13948],[1675,172,13955],[1676,173,13965],[1679,173,13971],[1681,173,13982],[1684,172,13987],[1686,171,13995],[1688,170,14003],[1689,169,14007],[1690,168,14015],[1688,167,14032],[1687,167,14039],[1685,168,14049],[1682,169,14055],[1680,171,14065],[1678,174,14067],[1677,177,14075],[1675,180,14083],[1675,184,14091],[1674,188,14099],[1674,192,14109],[1674,196,14120],[1674,200,14125],[1674,203,14128],[1674,206,14137],[1674,209,14145],[1673,210,14154],[1671,211,14161],[1670,211,14170],[1668,211,14177],[1666,209,14187],[1664,207,14189],[1662,205,14197],[1661,202,14205],[1660,200,14213],[1659,197,14221],[1660,194,14229],[1661,192,14238],[1663,190,14245],[1665,188,14253],[1669,188,14256],[1674,187,14265],[1679,187,14274],[1684,188,14281]],[[29,248,15613],[29,248,15619],[28,255,15639],[28,259,15647],[28,265,15655],[29,272,15663],[29,278,15671],[29,285,15679],[30,291,15687],[30,297,15695],[31,302,15699],[32,305,15707],[33,309,15723],[37,306,15747],[38,301,15755],[40,296,15759],[42,289,15767],[45,282,15775],[47,274,15783],[50,266,15791],[53,258,15799],[56,251,15807],[58,245,15817],[61,239,15822],[63,235,15832],[67,231,15844],[71,232,15863]],[[80,283,16057],[76,284,16059],[71,288,16075],[67,295,16092],[66,298,16100],[65,302,16109],[66,308,16120],[70,309,16136],[73,308,16144],[76,306,16153],[79,303,16161],[82,300,16168],[84,296,16176],[85,294,16180],[86,291,16193],[86,290,16196],[86,289,16211],[85,290,16220],[86,291,16229],[87,293,16237],[88,295,16241],[90,297,16250],[92,299,16261],[94,301,16265],[97,302,16279],[99,303,16282],[104,302,16297],[106,300,16301],[108,298,16312],[109,295,16316],[110,291,16329],[111,288,16333],[112,284,16346],[113,281,16349],[114,276,16363],[116,274,16369],[118,273,16380],[121,272,16385],[124,272,16395]],[[186,244,16661],[185,242,16667],[183,241,16675],[181,241,16683],[179,242,16691],[176,245,16699],[173,251,16707],[169,258,16715],[165,267,16719],[161,278,16727],[158,291,16735],[155,303,16743],[152,316,16751],[151,329,16759],[150,340,16767],[152,350,16775],[153,357,16779],[157,363,16787],[162,368,16795],[169,372,16803]],[[222,299,17488],[223,297,17495],[223,296,17499],[225,294,17507],[226,292,17515],[228,288,17523],[231,285,17531],[234,282,17539],[237,278,17547],[240,275,17555],[243,271,17560],[245,268,17567],[247,266,17577],[249,264,17583],[250,262,17593],[250,261,17599]],[[232,267,17721],[232,268,17727],[233,271,17735],[233,273,17739],[234,276,17747],[234,279,17755],[235,283,17763],[236,286,17771],[237,288,17779],[239,291,17787],[240,292,17795]],[[260,284,17884],[260,284,17891],[261,286,17899],[261,288,17907],[261,291,17916],[261,295,17920],[261,298,17932],[261,301,17937],[261,303,17949],[262,306,17952]],[[294,284,18125],[295,284,18131],[297,284,18139],[300,284,18147],[302,284,18155],[306,284,18159],[309,283,18167],[312,283,18175],[315,282,18183],[318,281,18191]],[[315,268,18281],[315,268,18287],[314,271,18295],[314,273,18303],[314,276,18312],[313,279,18319],[313,283,18329],[313,286,18336],[313,289,18340],[314,292,18350],[314,294,18356],[315,295,18367]],[[353,296,18521],[353,296,18527],[352,296,18535],[353,295,18543],[354,294,18551],[355,292,18559],[358,290,18567],[361,287,18575],[364,283,18580],[367,280,18587],[370,276,18597],[373,273,18603],[375,270,18619],[376,267,18621],[376,264,18629],[376,263,18636]],[[356,279,18741],[356,281,18747],[357,283,18755],[357,285,18759],[357,287,18767],[358,289,18775],[359,290,18783],[361,291,18791]],[[378,284,18869],[380,284,18875],[382,285,18879],[383,286,18887],[385,288,18898],[385,290,18903],[386,294,18911],[385,297,18919],[385,301,18927],[384,304,18935],[383,308,18939],[382,311,18948],[381,313,18955],[381,314,18965],[382,314,18985],[384,313,18988],[386,313,18996],[389,311,19004],[392,310,19008],[394,308,19019],[397,307,19025]],[[195,343,19377],[194,343,19383],[195,343,19399],[198,343,19407],[202,342,19416],[209,342,19419],[217,341,19427],[228,340,19435],[240,339,19443],[254,337,19451],[269,336,19459],[285,334,19467],[302,332,19475],[319,330,19479],[336,328,19487],[352,327,19495],[367,326,19503],[381,325,19511],[392,325,19519],[402,324,19527],[410,325,19536],[415,326,19540],[419,326,19549]],[[279,362,19940],[281,362,19947],[282,362,19955],[283,364,19959],[283,365,19968],[283,367,19975],[283,368,19985],[283,370,19991],[282,371,20001],[284,371,20019],[285,369,20027],[288,369,20035],[291,367,20043],[294,367,20051],[297,367,20059],[300,368,20068],[302,369,20077],[304,371,20080],[305,374,20089],[305,376,20096],[306,378,20105],[306,379,20113],[307,381,20123]],[[419,252,20593],[420,252,20599],[422,254,20607],[425,257,20615],[429,262,20620],[432,268,20627],[437,276,20637],[442,284,20643],[446,292,20657],[450,301,20659],[453,310,20667],[455,319,20675],[456,328,20679],[455,336,20687],[453,345,20695],[450,353,20704],[446,361,20711],[441,369,20721],[436,375,20727],[427,384,20741],[425,385,20749]],[[503,298,20972],[506,298,20979],[511,297,20987],[514,297,20995],[518,296,21005],[521,296,21012],[523,296,21025]],[[505,310,21081],[504,311,21087],[503,312,21091],[504,313,21107],[507,313,21115],[510,313,21123],[514,313,21132],[518,313,21142],[522,312,21148],[527,311,21152]],[[626,245,21440],[626,245,21447],[626,246,21455],[625,248,21459],[624,251,21467],[624,256,21475],[623,262,21483],[623,268,21491],[622,275,21499],[621,282,21507],[621,289,21517],[621,295,21520],[621,300,21531],[621,304,21537],[621,307,21547]],[[580,314,21665],[580,314,21671],[582,314,21679],[585,314,21687],[589,313,21695],[594,313,21699],[601,312,21707],[609,311,21715],[617,310,21723],[626,309,21732],[635,308,21746],[642,307,21748],[655,307,21764],[660,308,21768],[663,309,21779]],[[585,358,22001],[586,360,22007],[587,362,22015],[587,366,22025],[586,370,22031],[586,373,22041],[585,377,22047],[585,380,22055],[584,382,22059],[584,383,22067],[585,382,22083],[586,380,22097],[587,377,22100],[588,373,22112],[590,369,22116],[592,366,22120],[594,362,22128],[596,360,22136],[598,358,22145],[601,357,22152],[603,356,22164],[605,357,22168],[608,361,22181],[609,363,22189],[609,366,22200],[609,369,22205],[608,371,22216],[607,373,22220],[606,375,22231]],[[627,340,22401],[629,339,22407],[630,339,22415],[631,340,22419],[632,341,22427],[634,343,22435],[634,344,22443],[634,347,22451],[634,349,22459],[633,351,22467],[632,353,22479],[631,355,22482],[630,356,22489],[629,358,22498],[629,359,22515],[630,359,22521],[631,358,22532],[632,358,22536],[634,357,22541],[636,357,22551],[638,356,22557],[641,355,22568],[644,354,22573]],[[759,237,23149],[756,235,23155],[753,234,23163],[749,234,23171],[745,234,23179],[740,234,23187],[735,235,23195],[730,237,23199],[726,239,23207],[722,242,23215],[719,245,23223],[717,249,23231],[716,253,23239],[715,259,23247],[715,265,23251],[715,271,23261],[715,279,23272],[715,287,23277],[715,296,23288],[715,305,23292],[714,314,23303],[712,324,23309],[710,333,23313],[708,341,23323],[705,349,23335],[703,355,23339],[699,366,23355],[698,370,23363],[698,375,23374],[699,376,23382],[701,378,23388],[703,379,23398],[705,380,23403],[707,380,23415],[710,381,23419],[715,381,23432],[718,380,23440],[720,379,23449],[723,378,23456],[725,376,23469]],[[775,276,23801],[775,278,23807],[774,281,23815],[774,286,23823],[773,291,23831],[772,297,23839],[772,303,23847],[771,308,23855],[771,314,23859],[772,318,23867],[773,320,23875],[774,321,23883],[777,320,23891],[780,317,23899],[783,313,23907],[787,308,23916],[791,303,23921],[795,297,23929],[799,291,23940],[802,285,23944],[805,280,23955],[808,276,23961],[811,270,23972],[811,269,23984]],[[815,301,24116],[814,304,24123],[812,308,24131],[811,311,24139],[810,315,24148],[810,317,24151],[810,319,24160],[810,320,24169],[812,320,24176],[813,319,24185],[815,317,24192],[817,315,24202],[819,312,24208],[820,310,24212],[820,308,24220],[820,306,24229],[819,307,24244],[818,308,24254],[818,310,24261],[818,313,24270],[818,316,24272],[819,319,24281],[820,322,24289],[822,324,24297],[824,326,24305],[827,326,24313],[829,326,24321],[832,325,24328],[834,323,24337],[836,321,24340],[837,318,24353],[838,315,24356],[838,307,24372],[838,304,24381],[838,301,24389],[839,299,24393],[840,297,24422],[847,294,24426],[851,294,24436]],[[897,268,24640],[896,268,24647],[895,269,24655],[893,271,24664],[890,275,24671],[887,280,24679],[885,287,24687],[882,294,24691],[880,301,24700],[878,309,24707],[877,315,24717],[878,321,24723],[879,326,24733],[881,329,24739],[884,331,24747]],[[903,326,24948],[904,325,24955],[905,323,24963],[907,320,24971],[909,317,24979],[912,313,24987],[915,309,24991],[919,304,25001],[922,300,25007],[925,295,25018],[929,291,25023],[931,287,25031],[933,283,25039],[935,280,25047],[935,278,25051]],[[908,291,25145],[907,294,25151],[907,297,25159],[908,300,25168],[908,303,25171],[910,306,25179],[912,308,25187],[914,310,25195],[917,312,25203],[920,312,25211],[923,312,25219],[925,312,25227],[928,312,25231],[930,311,25240],[932,311,25249],[935,312,25257],[936,313,25265],[938,315,25273],[939,317,25281],[941,321,25289],[941,324,25292],[942,328,25307],[943,331,25309],[943,335,25317],[943,337,25326],[943,340,25333],[943,341,25341]],[[957,263,25693],[960,266,25699],[964,270,25707],[968,275,25711],[973,281,25720],[977,287,25727],[981,294,25737],[984,302,25743],[987,309,25753],[989,316,25759],[989,322,25767],[988,328,25771],[985,334,25781],[982,339,25793],[978,343,25796],[974,346,25810],[970,347,25813],[967,348,25827]],[[1017,319,25968],[1019,319,25975],[1022,320,25983],[1025,319,25991],[1029,319,25999],[1032,318,26007],[1035,316,26011],[1038,315,26021],[1040,312,26027]],[[1034,295,26113],[1033,298,26119],[1033,302,26127],[1033,307,26131],[1032,312,26139],[1032,318,26147],[1032,323,26155],[1032,328,26163],[1033,333,26176],[1034,336,26181],[1035,338,26193]],[[1073,301,26420],[1073,304,26427],[1073,307,26431],[1072,311,26439],[1071,316,26447],[1071,320,26456],[1071,324,26463],[1072,328,26472],[1073,330,26479],[1075,331,26489],[1078,331,26491],[1082,329,26500],[1086,327,26510],[1090,323,26516],[1094,319,26527],[1097,314,26533],[1100,309,26544],[1102,304,26549],[1104,299,26552],[1105,296,26562],[1106,292,26569],[1107,290,26580],[1107,288,26585]],[[1111,319,26713],[1111,322,26719],[1110,324,26727],[1110,327,26731],[1110,330,26740],[1110,333,26747],[1111,335,26757],[1112,337,26763],[1113,338,26773],[1115,338,26779],[1117,337,26788],[1119,336,26792],[1120,334,26799],[1122,331,26807],[1123,329,26815],[1123,326,26823],[1123,324,26833],[1123,323,26847],[1121,323,26852],[1121,324,26877],[1121,327,26881],[1121,329,26884],[1122,332,26894],[1124,333,26905],[1127,335,26915],[1129,335,26920],[1131,334,26927],[1134,332,26936],[1136,330,26943],[1137,327,26953],[1139,323,26964],[1140,320,26969],[1141,317,26973],[1142,314,26984],[1144,311,26988],[1145,309,26999],[1148,307,27005]],[[1197,286,27261],[1196,287,27267],[1194,288,27271],[1192,292,27279],[1190,296,27287],[1187,301,27295],[1184,308,27303],[1181,315,27311],[1179,322,27319],[1177,328,27327],[1176,335,27331],[1176,340,27340],[1177,344,27347],[1179,347,27355],[1182,348,27363]],[[1194,341,27521],[1194,341,27527],[1197,340,27535],[1200,339,27543],[1205,337,27551],[1209,334,27559],[1215,331,27567],[1220,327,27571],[1225,323,27579],[1230,319,27587],[1234,315,27595],[1238,312,27603],[1241,308,27611],[1242,305,27619],[1244,302,27627]],[[1221,312,27716],[1220,316,27723],[1218,321,27731],[1217,325,27739],[1216,330,27747],[1215,334,27751],[1215,338,27760],[1216,340,27767],[1217,342,27777]],[[1242,334,27860],[1243,335,27867],[1243,337,27879],[1243,339,27887],[1242,341,27895],[1241,344,27903],[1241,347,27911],[1240,350,27919],[1238,353,27927],[1237,356,27931],[1235,359,27940],[1234,361,27948],[1233,363,27956],[1232,364,27965],[1234,365,27980],[1236,364,27988],[1240,363,27992],[1245,362,28002],[1250,360,28009],[1255,358,28019]],[[1271,282,28292],[1274,284,28299],[1277,289,28307],[1281,294,28315],[1285,300,28323],[1289,308,28331],[1292,316,28339],[1294,324,28347],[1295,331,28351],[1295,339,28359],[1294,345,28367],[1291,350,28375],[1288,355,28383],[1284,358,28392],[1281,360,28400],[1278,361,28408]],[[1334,271,28685],[1338,269,28691],[1342,268,28699],[1347,267,28707],[1352,266,28713],[1357,265,28719],[1363,264,28730],[1368,264,28735],[1371,264,28743],[1374,265,28752],[1375,266,28761],[1376,270,28769],[1374,274,28772],[1373,280,28784],[1371,287,28788],[1369,295,28801],[1368,304,28804],[1368,312,28819],[1369,320,28822],[1371,328,28829],[1374,335,28837],[1378,341,28840],[1381,347,28851],[1385,352,28857],[1387,357,28869],[1389,362,28873],[1389,367,28887],[1389,372,28890],[1387,377,28893],[1383,382,28903],[1379,387,28909],[1373,391,28920],[1367,396,28924],[1361,400,28933],[1355,402,28939],[1348,405,28950],[1343,406,28952]]]

        function get_point(evt){

            pt = {
                x: relx(evt),
                y: rely(evt),
                timestamp: time()
            }

            if(PEN){
                pt.pressure = evt.pressure
            }

            return pt
        }

        function get_ctx(){
            return $('#canv').get(0).getContext('2d');
        }

        function time() {
            var d = new Date();
            return d.getTime();
        }

        function drawLine(from, to, lineColor, lineWidth) {
            var ctx = get_ctx()
            ctx.beginPath();
            ctx.moveTo(from.x, from.y);
            ctx.lineTo(to.x, to.y);

            ctx.strokeStyle = (lineColor == undefined)? '#333' : lineColor
            ctx.lineWidth = (lineWidth == undefined)? 2 : lineWidth
            ctx.lineCap = 'round'

            ctx.stroke();
        }


        function draw_point(coord){
            var ctx = get_ctx()
            ctx.beginPath();
            ctx.fillStyle = '#222'
            ctx.fillRect(coord.x-1, coord.y-1, 3, 3 )
        }

        function on_clear() {
            var ctx = get_ctx()
            ctx.clearRect(0, 0, $("#canv").width(), $("#canv").height())

            nevt = 0
            runavg = 0


        }

        function start_collecting(){
            collecting = true
        }

        function stop_collecting(){
            collecting = false
            CURVES = norm_time(CURVES)
            console.log(JSON.stringify(CURVES))
        }

        function resize_canvas() {
            var iw = $(window).width();
            var ih = $(window).height();

            $('#canv')[0].width = 0.9 * iw
            $('#canv')[0].height = 0.8 * ih
        }



        function relx(event){
            return event.pageX - $("#canv").offset().left
        }

        function rely(event){
            return event.pageY - $("#canv").offset().top
        }

        function point_to_list(p){
            pt = [Math.round(10*p.x)/10, Math.round(10*p.y)/10, p.timestamp]
            if (p.pressure != undefined){
                pt.push( Math.round(p.pressure*1000)/1000)
            }
            return pt
        }



        function info_update(tm, draw) {
            if (last_timestamp > 0) {

                delta = tm - last_timestamp;
                eps = 1000 / delta
                runavg = (runavg * nevt + eps) / (nevt + 1)
                nevt = nevt + 1

                $("#perf").text(Math.round(eps))
                $("#runavg").text(Math.round(runavg))
                $("#draw").text(Math.round(draw))
            }

            last_timestamp = tm;
        }


         function on_mousedown(event) {
            event.preventDefault()
            lmb_down = true
            inline = true
            //console.log('mousedown')
            curcurv = [] // start a new curve
            last_point = get_point(event)

            if (mode == modes.point){
                draw_point(last_point)
            }

            if (collecting){curcurv.push(point_to_list(last_point))}

        }
        function on_mousemove(event) {
            tm = time()
            if (lmb_down) {
                cur_point = get_point(event)

                if (mode == modes.point)
                {
                    draw_point(cur_point)
                }
                else if (mode == modes.line) {
                    if (PEN){
                        avg_pressure = 0.5*(last_point.pressure + cur_point.pressure)

                        if (PRESSURE_COLOR){
                            alpha = (1-PRESSURE_WEIGHT) + PRESSURE_WEIGHT*avg_pressure
                            color = 'rgba(32,32,32,' + alpha + ')'
                        }
                        else{
                            color = 'rgba(64,64,64,1)'
                        }

                        if (PRESSURE_WIDTH){
                            width = 1 + Math.round(4*avg_pressure)
                        }
                        else{
                            width = 2
                        }

                        drawLine(cur_point, last_point, color, width )
                    }
                    else {
                        drawLine(last_point, cur_point)
                    }

                }
                else{
                    alert ("unknown drawing mode")
                }

               //

                last_point = cur_point
                info_update(tm, time() - tm)

                if(collecting){
                 curcurv.push(point_to_list(last_point))
                }

            }
            event.preventDefault()
        }
        function on_mouseup(event) {
            event.preventDefault()

            if(lmb_down && collecting){
               CURVES.push(curcurv)
            }

            lmb_down = false
            inline = false
            last_timestamp = 0

            //console.log('mouseup')

        }

        function multidraw(n) {

            for (var i = 0; i < n; i = i+1) {

                a = {}
                b = {}
                a.x = i % 100
                a.y = i % 100 + 1

                b.x = i % 100 + 50
                b.y = i % 100 + 51

                drawLine(a, b)
            }
        }
        function run_lps_test(){
            N = 10000
            ta = time()
            multidraw(N)
            tb = time()

            lpms = N / (tb - ta)

            $("#mdraw").text(Math.round(lpms))
            on_clear()
        }

        function norm_time(curves){

            if (curves.length > 0)
            {
                time_zero = curves[0][0][2]
                for(i=0; i<curves.length; i++){
                    for (j=0; j<curves[i].length; j++){
                        curves[i][j][2] -= time_zero
                    }
                }
            }



            return curves
        }

        function replay(capture){

            for (i=0; i<capture.length; i++){
                curve = capture[i]

                for(j=1; j<curve.length; j++){
                    point = curve[j]
                    from = {}
                    to = {}
                    from.x = curve[j-1][0]
                    from.y = curve[j-1][1]
                    to.x = curve[j][0]
                    to.y = curve[j][1]

                    drawLine(from, to)
                }
            }
        }


        function replay_smooth(capture){

            for (i=0; i<capture.length; i++){
                curve = capture[i]

                for(j=2; j<curve.length; j += 2){
                    point = curve[j]
                    from = {}
                    to = {}
                    ctrl = {}
                    from.x = curve[j-2][0]
                    from.y = curve[j-2][1]
                    ctrl.x = curve[j-1][0]
                    ctrl.y = curve[j-1][1]
                    to.x = curve[j][0]
                    to.y = curve[j][1]


                    ctx = get_ctx()
                    ctx.strokeStyle = '#222'
                    ctx.lineWidth = 2
                    ctx.beginPath()
                    ctx.moveTo(from.x, from.y)
                    ctx.quadraticCurveTo(ctrl.x, ctrl.y, to.x, to.y)
                    ctx.stroke()


                    drawLine(from, to)
                }
            }
        }


        function replay_smooth2(capture){

            for (i=0; i<capture.length; i++){
                curve = capture[i]

                for(j=1; j<curve.length; j+= 2){

                }
            }
        }


        function replay_time(capture){

            start_time = time()

            for (i=0; i<capture.length; i++){
                curve = capture[i]

                for(j=1; j<curve.length; j++){
                    point = curve[j]
                    from = {}
                    to = {}
                    from.x = curve[j-1][0]
                    from.y = curve[j-1][1]
                    from.timestamp = curve[j-1][2]
                    to.x = curve[j][0]
                    to.y = curve[j][1]
                    to.timestamp = curve[j][2]

                    wait = to.timestamp - (time() - start_time)
                    if (wait > 0)
                    {
                        setTimeout(function(){drawLine(from, to)}, wait)
                    }
                    else{
                       drawLine(from, to)
                    }




                }
            }
        }

        function hello(){ console.log('hello')}


        function ie10_pointer(){
            var ie10 = /MSIE (\d+)/.exec(navigator.userAgent)

            if (ie10 != null){

                version = parseInt( ie10[1])
                if (version >= 10){
                    ie10 = true
                }
                else{
                    ie10 = false
                }
            }
            else{
                ie10 = false
            }

            var pointer = navigator.msPointerEnabled ? true : false

            if (ie10 && pointer){
                return true
            }
            else {
                return false
            }
        }

        function init() {
	    new FastClick(document.body);

            PEN = ie10_pointer()

            console.log(PEN?'Pointer Enabled Device':'Pointer Disabled Device')


            if(PEN){
                canvas = document.getElementById('canv');
                canvas.addEventListener("MSPointerUp", on_mouseup, false);
                canvas.addEventListener("MSPointerMove", on_mousemove, false);
                canvas.addEventListener("MSPointerDown", on_mousedown, false);
            }
            else {
                $('#canv').mousedown(on_mousedown)
                $('#canv').mousemove(on_mousemove)
                $(window).mouseup(on_mouseup)
                /*
                canvas = $("#canv")[0]
                canvas.addEventListener('touchstart', on_mousedown, false);
                canvas.addEventListener('touchmove', on_mousemove, false);
                window.addEventListener('touchend', on_mouseup, false);
                */ 
           }


            //$(window).resize(resize_canvas)

            /*
            //ignore touch events for now
            canvas = $("#canv")[0]
            canvas.addEventListener('touchstart', on_mousedown, false);
            canvas.addEventListener('touchmove', on_mousemove, false);
            window.addEventListener('touchend', on_mouseup, false);

            */
            //run_lps_test()
            resize_canvas();

            //replay_smooth(CAPTURE)
        }

    function rough(){
        replay(CAPTURE)
    }

    function smooth(){
        replay_smooth(CAPTURE)
    }

    </script>
</head>

<body onload="init();">

<div style="overflow: hidden;">

    <div class="info">Average events per second: <span id="runavg">??</span>
    </div>
    <div class="info">Frame drawing time <span id="draw">??</span></div>
    <div class="info">lines per ms <span id="mdraw">??</span></div>
    <div class="info">Events per second: <span id="perf">??</span></div>
</div>
<div>
    <button id="clear" onclick="on_clear();">Clear</button>
    <button  onclick="mode=modes.line;">Lines</button>
    <button onclick="mode=modes.point">points</button>
    <button onclick="rough()">rough</button>
    <button onclick="smooth()">smooth</button>
        <button onclick="start_collecting()">start collecting</button>
        <button onclick="stop_collecting()">stop collecting</button>
</div>
<div>
    <canvas id="canv" width="600" height="400"></canvas>
</div>


</body>


</html>

